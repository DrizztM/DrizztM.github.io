---
layout: post
title: 产品开发中的一些小经验
category: 技术
keywords: 经验
---

## 一些经验，随时补充

1.	nginx可以代理tcp服务，但是无法获取用户真实ip。阿里云的SLB支持tcp协议获取用户真实ip。
2.	高并发下采用mysql数据库，必须要做读写分离，同时充分利用缓存机制辅助数据储存。
3.	将sql语句放到Map中，update语句只执行最后一句，一旦有delete语句，前面的sql全部删除。
4.	逐步将关系型数据库向非关系型数据库中转移。
5.	尽量采用域名方式发布应用。
6.	使用git管理项目时，最少建立两个分支——master和dev。开发人员在dev分支上进行开发，程序测试通过时，再将dev分支合并到master分支。每个版本建立一个tag。
7.	必须准备一套和生产环境相同的测试环境。
8.	尽量不要采用自增主键，有锁，影响效率。
9.	在手机采用3G/4G等移动网络上网时，当来电时，电信手机3G/4G会断网，移动联通4G会断网，在断线重连后，ip很有可能发生改变，这时如果采用socket连接时，连接会关闭；同时，如果nginx采用ip hash算法找节点服务器的策略时，很有可能跑到其他服务器上。
10.	在做长连接时，信息需要有来有回。

